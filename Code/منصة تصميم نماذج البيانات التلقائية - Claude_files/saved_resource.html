<!DOCTYPE html>
<!-- saved from url=(0012)about:srcdoc -->
<html lang="ar" dir="rtl"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html-to-image/1.11.13/html-to-image.min.js" integrity="sha512-iZ2ORl595Wx6miw+GuadDet4WQbdSWS3JLMoNfY8cRGoEFy6oT3G9IbcrBeL6AfkgpA51ETt/faX6yLV+/gFJg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
      (function() {
        const originalConsole = window.console;
        window.console = {
          log: (...args) => {
            originalConsole.log(...args);
            window.parent.postMessage({ type: 'console', message: args.join(' ') }, '*');
          },
          error: (...args) => {
            originalConsole.error(...args);
            window.parent.postMessage({ type: 'console', message: 'Error: ' + args.join(' ') }, '*');
          },
          warn: (...args) => {
            originalConsole.warn(...args);
            window.parent.postMessage({ type: 'console', message: 'Warning: ' + args.join(' ') }, '*');
          }
        };

        let requestId = 0;
        let callbacksMap = new Map();
        let streamControllers = new Map();
        
        window.claude = {
          complete: (prompt) => {
            return new Promise((resolve, reject) => {
              const id = requestId++;
              callbacksMap.set(id, { resolve, reject });
              window.parent.postMessage({ type: 'claudeComplete', id, prompt }, '*');
            });
          }
        };

        window.storage = {
          get: (key, shared = false) => {
            return new Promise((resolve, reject) => {
              const id = requestId++;
              callbacksMap.set(id, { resolve, reject });
              window.parent.postMessage({ type: 'storageGet', id, key, shared }, '*');
            });
          },
          set: (key, value, shared = false) => {
            return new Promise((resolve, reject) => {
              const id = requestId++;
              callbacksMap.set(id, { resolve, reject });
              window.parent.postMessage({ type: 'storageSet', id, key, value, shared }, '*');
            });
          },
          delete: (key, shared = false) => {
            return new Promise((resolve, reject) => {
              const id = requestId++;
              callbacksMap.set(id, { resolve, reject });
              window.parent.postMessage({ type: 'storageDelete', id, key, shared }, '*');
            });
          },
          list: (prefix, shared = false) => {
            return new Promise((resolve, reject) => {
              const id = requestId++;
              callbacksMap.set(id, { resolve, reject });
              window.parent.postMessage({ type: 'storageList', id, prefix, shared }, '*');
            });
          }
        };

        let pendingBlobs = new Map();
        URL.createObjectURL = (blob) => {
          // Store the blob and create an ID and URL for it
          const blobId = `blob-${Date.now()}-${Math.random()}`;
          pendingBlobs.set(blobId, blob);
          return `blob-request://${blobId}`;
        };

        URL.revokeObjectURL = (url) => {
          // Remove the blob from our store
          const blobId = url.replace("blob-request://", "");
          pendingBlobs.delete(blobId);
        };

        const getBlobFromURL = (url) => {
          const blobId = url.replace("blob-request://", "");
          return pendingBlobs.get(blobId);
        };

        // Override global fetch with streaming support
        window.fetch = (url, init = {}) => {
          return new Promise((resolve, reject) => {
            const id = requestId++;
            const channelId = `fetch-${id}-${Date.now()}`;
            
            callbacksMap.set(id, { 
              resolve: (response) => {
                // Create a ReadableStream for the response body
                const stream = new ReadableStream({
                  start(controller) {
                    streamControllers.set(channelId, controller);
                  },
                  cancel() {
                    streamControllers.delete(channelId);
                  }
                });
                
                // Create and return the Response with the stream
                resolve(new Response(stream, {
                  status: response.status,
                  statusText: response.statusText,
                  headers: response.headers
                }));
              },
              reject,
              channelId
            });
            
            window.parent.postMessage({
              type: 'proxyFetch',
              id,
              url,
              init,
              channelId
            }, '*');
          });
        };

        window.addEventListener('message', async (event) => {
          if (event.data.type === 'takeScreenshot') {
            const rootElement = document.getElementById('artifacts-component-root-html');
            if (!rootElement) {
              window.parent.postMessage({
                type: 'screenshotError',
                error: new Error('Root element not found'),
              }, '*');
            }
            const screenshot = await htmlToImage.toPng(rootElement, {
              imagePlaceholder:
                "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAA1JREFUGFdjePDgwX8ACOQDoNsk0PMAAAAASUVORK5CYII=",
            });
            window.parent.postMessage({
              type: 'screenshotData',
              data: screenshot,
            }, '*');
          } else if (event.data.type === 'claudeComplete') {
            const callback = callbacksMap.get(event.data.id);
            if (event.data.error) {
              callback.reject(new Error(event.data.error));
            } else {
              callback.resolve(event.data.completion);
            }
            callbacksMap.delete(event.data.id);
          } else if (event.data.type === 'proxyFetchResponse') {
            const callback = callbacksMap.get(event.data.id);
            if (event.data.error) {
              callback.reject(new Error(event.data.error));
              callbacksMap.delete(event.data.id);
            } else {
              // Initial response with headers, status, etc.
              callback.resolve({
                status: event.data.status,
                statusText: event.data.statusText,
                headers: event.data.headers
              });
              // Don't delete the callback yet if streaming
              if (!event.data.body) {
                callbacksMap.delete(event.data.id);
              }
            }
          } else if (event.data.type === 'proxyFetchStream') {
            // Handle streaming data chunks
            const controller = streamControllers.get(event.data.channelId);
            if (controller) {
              if (event.data.error) {
                controller.error(new Error(event.data.error));
                streamControllers.delete(event.data.channelId);
              } else if (event.data.done) {
                controller.close();
                streamControllers.delete(event.data.channelId);
                // Clean up the callback
                const callback = Array.from(callbacksMap.entries()).find(
                  ([_, value]) => value.channelId === event.data.channelId
                );
                if (callback) {
                  callbacksMap.delete(callback[0]);
                }
              } else if (event.data.chunk) {
                controller.enqueue(new Uint8Array(event.data.chunk));
              }
            }
          } else if (event.data.type === 'storageGet') {
            const callback = callbacksMap.get(event.data.id);
            if (event.data.error) {
              callback.reject(new Error(event.data.error));
            } else {
              callback.resolve(event.data.result);
            }
            callbacksMap.delete(event.data.id);
          } else if (event.data.type === 'storageSet') {
            const callback = callbacksMap.get(event.data.id);
            if (event.data.error) {
              callback.reject(new Error(event.data.error));
            } else {
              callback.resolve(event.data.result);
            }
            callbacksMap.delete(event.data.id);
          } else if (event.data.type === 'storageDelete') {
            const callback = callbacksMap.get(event.data.id);
            if (event.data.error) {
              callback.reject(new Error(event.data.error));
            } else {
              callback.resolve(event.data.result);
            }
            callbacksMap.delete(event.data.id);
          } else if (event.data.type === 'storageList') {
            const callback = callbacksMap.get(event.data.id);
            if (event.data.error) {
              callback.reject(new Error(event.data.error));
            } else {
              callback.resolve(event.data.result);
            }
            callbacksMap.delete(event.data.id);
          }
        });

        window.addEventListener('click', (event) => {
          const isEl = event.target instanceof HTMLElement;
          if (!isEl) return;
    
          // find ancestor links
          const linkEl = event.target.closest("a");
          if (!linkEl || !linkEl.href) return;
    
          event.preventDefault();
          event.stopImmediatePropagation();
    
          if (linkEl.href.startsWith("blob-request:")) {
            const blob = getBlobFromURL(linkEl.href);
            if (!blob) return;
            void blob.arrayBuffer().then((data) => {
              window.parent.postMessage({
                type: "downloadFile",
                filename: linkEl.download,
                data,
                mimeType: blob.type || "application/octet-stream",
              });
            });
          } else if (linkEl.href.startsWith("data:")) {
            const [header, base64Data] = linkEl.href.split(",");
            const mimeMatch = header.match(/data:([^;]+)/);
            const mimeType = mimeMatch ? mimeMatch[1] : "application/octet-stream";
            const binaryString = atob(base64Data);
            const data = Uint8Array.from(binaryString, (c) =>
              c.charCodeAt(0),
            ).buffer;
            window.parent.postMessage({
              type: "downloadFile",
              filename: linkEl.download,
              data,
              mimeType,
            });
          } else {
            let linkUrl;
            try {
              linkUrl = new URL(linkEl.href);
            } catch (error) {
              return;
            }
    
            if (linkUrl.hostname === window.location.hostname) return;
      
            window.parent.postMessage({
              type: 'openExternal',
              href: linkEl.href,
            }, '*');
          }
      });

        const originalOpen = window.open;
        window.open = function (url) {
          window.parent.postMessage({
            type: "openExternal",
            href: url,
          }, "*");
        };

        window.addEventListener('error', (event) => {
          window.parent.postMessage({ type: 'console', message: 'Uncaught Error: ' + event.message }, '*');
        });
      })();
    </script>
  
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منشئ النماذج الذكي - AI Form Builder</title>
    <meta name="description" content="أنشئ نماذجك المخصصة باستخدام الذكاء الاصطناعي - صمم وشارك نماذج تفاعلية بسهولة">
    <meta name="keywords" content="نماذج، forms، ذكاء اصطناعي، AI، استبيان، تسجيل">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com/"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin="" src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin="" src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        
        body {
            font-family: 'Cairo', sans-serif;
        }
        
        * {
            font-family: 'Cairo', sans-serif;
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}</style></head>
<body id="artifacts-component-root-html">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const Plus = () => (
            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
            </svg>
        );
        
        const Trash2 = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
        );
        
        const Save = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
            </svg>
        );
        
        const FileText = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
        );
        
        const Sparkles = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
            </svg>
        );
        
        const Download = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
        );
        
        const Upload = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
            </svg>
        );

        function FormBuilder() {
          const [mode, setMode] = useState('home');
          const [forms, setForms] = useState([]);
          const [currentForm, setCurrentForm] = useState(null);
          const [formTitle, setFormTitle] = useState('');
          const [formFields, setFormFields] = useState([]);
          const [responses, setResponses] = useState({});
          const [aiPrompt, setAiPrompt] = useState('');
          const [isGenerating, setIsGenerating] = useState(false);

          useEffect(() => {
            const loadForms = () => {
              try {
                const savedForms = localStorage.getItem('forms');
                if (savedForms) {
                  setForms(JSON.parse(savedForms));
                }
              } catch (error) {
                console.log('No saved forms yet');
              }
            };
            loadForms();
          }, []);

          const saveForms = (updatedForms) => {
            localStorage.setItem('forms', JSON.stringify(updatedForms));
            setForms(updatedForms);
          };

          const generateFormWithAI = async () => {
            if (!aiPrompt.trim()) {
              alert('الرجاء إدخال وصف للنموذج');
              return;
            }

            setIsGenerating(true);
            try {
              const response = await fetch("https://api.anthropic.com/v1/messages", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  model: "claude-sonnet-4-20250514",
                  max_tokens: 1000,
                  messages: [
                    {
                      role: "user",
                      content: `أنت مساعد لإنشاء نماذج. بناءً على الوصف التالي، قم بإنشاء نموذج مناسب.

الوصف: ${aiPrompt}

قم بإرجاع JSON فقط بدون أي نص إضافي أو markdown، بالصيغة التالية:
{
  "title": "عنوان النموذج",
  "fields": [
    {
      "label": "اسم الحقل",
      "type": "نوع الحقل (text, email, number, tel, date, textarea)",
      "required": true أو false
    }
  ]
}

يجب أن يكون JSON صالحاً تماماً بدون أي نص قبله أو بعده.`
                    }
                  ],
                })
              });

              const data = await response.json();
              const content = data.content.find(item => item.type === 'text')?.text || '';
              
              const jsonMatch = content.match(/\{[\s\S]*\}/);
              if (!jsonMatch) {
                throw new Error('لم يتم العثور على JSON صالح');
              }

              const formData = JSON.parse(jsonMatch[0]);
              
              setFormTitle(formData.title || '');
              setFormFields(formData.fields.map((field, index) => ({
                id: Date.now() + index,
                label: field.label,
                type: field.type || 'text',
                required: field.required || false
              })));
              
              setMode('create');
              setAiPrompt('');
            } catch (error) {
              console.error('Error:', error);
              alert('حدث خطأ أثناء توليد النموذج. الرجاء المحاولة مرة أخرى.');
            } finally {
              setIsGenerating(false);
            }
          };

          const addField = () => {
            setFormFields([...formFields, {
              id: Date.now(),
              label: '',
              type: 'text',
              required: false
            }]);
          };

          const updateField = (id, key, value) => {
            setFormFields(formFields.map(field => 
              field.id === id ? { ...field, [key]: value } : field
            ));
          };

          const removeField = (id) => {
            setFormFields(formFields.filter(field => field.id !== id));
          };

          const saveForm = () => {
            if (!formTitle.trim() || formFields.length === 0) {
              alert('الرجاء إدخال عنوان النموذج وإضافة حقل واحد على الأقل');
              return;
            }

            const newForm = {
              id: Date.now(),
              title: formTitle,
              fields: formFields,
              createdAt: new Date().toISOString()
            };

            const updatedForms = [...forms, newForm];
            saveForms(updatedForms);
            setFormTitle('');
            setFormFields([]);
            setMode('home');
            alert('تم حفظ النموذج بنجاح!');
          };

          const fillForm = (form) => {
            setCurrentForm(form);
            setResponses({});
            setMode('fill');
          };

          const submitResponse = () => {
            const required = currentForm.fields.filter(f => f.required);
            const missing = required.filter(f => !responses[f.id] || responses[f.id].trim() === '');
            
            if (missing.length > 0) {
              alert('الرجاء تعبئة جميع الحقول المطلوبة');
              return;
            }

            alert('تم إرسال النموذج بنجاح!');
            console.log('Form Response:', responses);
            setMode('home');
            setCurrentForm(null);
            setResponses({});
          };

          const deleteForm = (formId) => {
            if (window.confirm('هل أنت متأكد من حذف هذا النموذج؟')) {
              const updatedForms = forms.filter(f => f.id !== formId);
              saveForms(updatedForms);
            }
          };

          const exportForms = () => {
            const dataStr = JSON.stringify(forms, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'forms-backup.json';
            link.click();
            URL.revokeObjectURL(url);
          };

          const importForms = async (event) => {
            const file = event.target.files[0];
            if (!file) return;

            try {
              const text = await file.text();
              const importedForms = JSON.parse(text);
              saveForms(importedForms);
              alert('تم استيراد النماذج بنجاح!');
            } catch (error) {
              alert('حدث خطأ أثناء استيراد النماذج');
            }
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-6" dir="rtl">
              <div className="max-w-5xl mx-auto">
                {/* Header */}
                <div className="bg-white rounded-2xl shadow-2xl p-8 mb-6 border-t-4 border-indigo-600">
                  <h1 className="text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 mb-3 flex items-center gap-3">
                    <FileText className="w-12 h-12 text-indigo-600" />
                    منشئ النماذج الذكي
                  </h1>
                  <p className="text-gray-600 text-lg">صمم نماذجك باستخدام الذكاء الاصطناعي في ثوانٍ</p>
                </div>

                {/* Home Mode */}
                {mode === 'home' && (
                  <div className="space-y-6">
                    {/* AI Generation Box */}
                    <div className="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-2xl shadow-2xl p-8 text-white">
                      <div className="flex items-center gap-3 mb-4">
                        <Sparkles className="w-8 h-8" />
                        <h2 className="text-3xl font-bold">أنشئ نموذجاً بالذكاء الاصطناعي</h2>
                      </div>
                      <p className="mb-6 text-indigo-100">صف النموذج الذي تريده وسيقوم الذكاء الاصطناعي بإنشائه تلقائياً</p>
                      
                      <div className="space-y-4">
                        <textarea
                          value={aiPrompt}
                          onChange={(e) => setAiPrompt(e.target.value)}
                          placeholder="مثال: نموذج تسجيل موظف جديد يحتوي على الاسم والبريد الإلكتروني والهاتف والمؤهل الدراسي..."
                          className="w-full px-4 py-3 rounded-xl text-gray-800 focus:outline-none focus:ring-4 focus:ring-white/50 resize-none"
                          rows="3"
                          disabled={isGenerating}
                        />
                        
                        <button
                          onClick={generateFormWithAI}
                          disabled={isGenerating}
                          className="w-full bg-white text-indigo-600 px-6 py-4 rounded-xl font-bold text-lg hover:bg-indigo-50 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg"
                        >
                          {isGenerating ? (
                            <>
                              <div className="w-6 h-6 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin"></div>
                              جاري التوليد...
                            </>
                          ) : (
                            <>
                              <Sparkles className="w-6 h-6" />
                              توليد النموذج
                            </>
                          )}
                        </button>
                      </div>
                    </div>

                    {/* Manual Creation */}
                    <div className="flex gap-4">
                      <button
                        onClick={() => setMode('create')}
                        className="flex-1 bg-white text-indigo-600 px-6 py-4 rounded-xl font-semibold text-lg hover:bg-indigo-50 transition flex items-center justify-center gap-2 shadow-lg border-2 border-indigo-600"
                      >
                        <Plus />
                        إنشاء نموذج يدوياً
                      </button>
                    </div>

                    {/* Export/Import */}
                    <div className="bg-white rounded-2xl shadow-xl p-6">
                      <h3 className="text-xl font-bold text-gray-800 mb-4">إدارة النماذج</h3>
                      <div className="flex gap-4">
                        <button
                          onClick={exportForms}
                          disabled={forms.length === 0}
                          className="flex-1 bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"
                        >
                          <Download className="w-5 h-5" />
                          تصدير النماذج
                        </button>
                        
                        <label className="flex-1 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition cursor-pointer flex items-center justify-center gap-2">
                          <Upload className="w-5 h-5" />
                          استيراد نماذج
                          <input
                            type="file"
                            accept=".json"
                            onChange={importForms}
                            className="hidden"
                          />
                        </label>
                      </div>
                    </div>

                    {/* Forms List */}
                    <div className="bg-white rounded-2xl shadow-xl p-8">
                      <h2 className="text-2xl font-bold text-gray-800 mb-6">النماذج المحفوظة ({forms.length})</h2>
                      {forms.length === 0 ? (
                        <div className="text-center py-12">
                          <FileText className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                          <p className="text-gray-500 text-lg">لا توجد نماذج محفوظة بعد</p>
                          <p className="text-gray-400 mt-2">استخدم الذكاء الاصطناعي أو أنشئ نموذجاً يدوياً</p>
                        </div>
                      ) : (
                        <div className="grid gap-4">
                          {forms.map(form => (
                            <div key={form.id} className="border-2 border-gray-200 rounded-xl p-6 hover:border-indigo-400 hover:shadow-lg transition">
                              <div className="flex justify-between items-start mb-3">
                                <div>
                                  <h3 className="text-xl font-bold text-gray-800 mb-1">{form.title}</h3>
                                  <p className="text-gray-500 text-sm">تم الإنشاء: {new Date(form.createdAt).toLocaleDateString('ar-SA')}</p>
                                </div>
                                <button
                                  onClick={() => deleteForm(form.id)}
                                  className="text-red-500 hover:text-red-700 hover:bg-red-50 p-2 rounded-lg transition"
                                >
                                  <Trash2 className="w-5 h-5" />
                                </button>
                              </div>
                              <p className="text-gray-600 mb-4">
                                <span className="font-semibold">{form.fields.length}</span> حقل
                              </p>
                              <button
                                onClick={() => fillForm(form)}
                                className="bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-2 rounded-lg hover:from-green-600 hover:to-emerald-700 transition font-semibold shadow-md"
                              >
                                تعبئة النموذج
                              </button>
                            </div>
                          ))}
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {/* Create Mode */}
                {mode === 'create' && (
                  <div className="bg-white rounded-2xl shadow-xl p-8">
                    <div className="flex justify-between items-center mb-6">
                      <h2 className="text-2xl font-bold text-gray-800">إنشاء نموذج جديد</h2>
                      <button
                        onClick={() => setMode('home')}
                        className="text-gray-600 hover:text-gray-800 font-semibold px-4 py-2 hover:bg-gray-100 rounded-lg transition"
                      >
                        إلغاء
                      </button>
                    </div>

                    <div className="mb-6">
                      <label className="block text-gray-700 font-semibold mb-2">عنوان النموذج</label>
                      <input
                        type="text"
                        value={formTitle}
                        onChange={(e) => setFormTitle(e.target.value)}
                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none"
                        placeholder="مثال: نموذج التسجيل"
                      />
                    </div>

                    <div className="space-y-4 mb-6">
                      <div className="flex justify-between items-center">
                        <h3 className="text-xl font-bold text-gray-800">الحقول ({formFields.length})</h3>
                        <button
                          onClick={addField}
                          className="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition flex items-center gap-2 shadow-md"
                        >
                          <Plus />
                          إضافة حقل
                        </button>
                      </div>

                      {formFields.length === 0 && (
                        <div className="text-center py-8 border-2 border-dashed border-gray-300 rounded-lg">
                          <p className="text-gray-500">لا توجد حقول بعد. اضغط "إضافة حقل" للبدء</p>
                        </div>
                      )}

                      {formFields.map((field, index) => (
                        <div key={field.id} className="border-2 border-gray-200 rounded-lg p-4 hover:border-indigo-300 transition">
                          <div className="flex justify-between items-start mb-3">
                            <span className="text-gray-600 font-semibold bg-gray-100 px-3 py-1 rounded-full">حقل {index + 1}</span>
                            <button
                              onClick={() => removeField(field.id)}
                              className="text-red-500 hover:text-red-700 hover:bg-red-50 p-2 rounded-lg transition"
                            >
                              <Trash2 className="w-4 h-4" />
                            </button>
                          </div>

                          <div className="grid gap-3">
                            <input
                              type="text"
                              value={field.label}
                              onChange={(e) => updateField(field.id, 'label', e.target.value)}
                              placeholder="اسم الحقل"
                              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none"
                            />

                            <select
                              value={field.type}
                              onChange={(e) => updateField(field.id, 'type', e.target.value)}
                              className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none"
                            >
                              <option value="text">نص قصير</option>
                              <option value="textarea">نص طويل</option>
                              <option value="email">بريد إلكتروني</option>
                              <option value="number">رقم</option>
                              <option value="tel">هاتف</option>
                              <option value="date">تاريخ</option>
                            </select>

                            <label className="flex items-center gap-2 cursor-pointer">
                              <input
                                type="checkbox"
                                checked={field.required}
                                onChange={(e) => updateField(field.id, 'required', e.target.checked)}
                                className="w-4 h-4 accent-indigo-600"
                              />
                              <span className="text-gray-700">حقل إجباري</span>
                            </label>
                          </div>
                        </div>
                      ))}
                    </div>

                    <button
                      onClick={saveForm}
                      className="w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-4 rounded-xl font-bold text-lg hover:from-green-700 hover:to-emerald-700 transition flex items-center justify-center gap-2 shadow-lg"
                    >
                      <Save className="w-6 h-6" />
                      حفظ النموذج
                    </button>
                  </div>
                )}

                {/* Fill Mode */}
                {mode === 'fill' && currentForm && (
                  <div className="bg-white rounded-2xl shadow-xl p-8">
                    <div className="flex justify-between items-center mb-6">
                      <h2 className="text-2xl font-bold text-gray-800">{currentForm.title}</h2>
                      <button
                        onClick={() => setMode('home')}
                        className="text-gray-600 hover:text-gray-800 font-semibold px-4 py-2 hover:bg-gray-100 rounded-lg transition"
                      >
                        إلغاء
                      </button>
                    </div>

                    <div className="space-y-6 mb-6">
                      {currentForm.fields.map(field => (
                        <div key={field.id}>
                          <label className="block text-gray-700 font-semibold mb-2">
                            {field.label}
                            {field.required && <span className="text-red-500 mr-1">*</span>}
                          </label>
                          {field.type === 'textarea' ? (
                            <textarea
                              value={responses[field.id] || ''}
                              onChange={(e) => setResponses({...responses, [field.id]: e.target.value})}
                              className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none"
                              rows="4"
                              required={field.required}
                            />
                          ) : (
                            <input
                              type={field.type}
                              value={responses[field.id] || ''}
                              onChange={(e) => setResponses({...responses, [field.id]: e.target.value})}
                              className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none"
                              required={field.required}
                            />
                          )}
                        </div>
                      ))}
                    </div>

                    <button
                      onClick={submitResponse}
                      className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-4 rounded-xl font-bold text-lg hover:from-indigo-700 hover:to-purple-700 transition shadow-lg"
                    >
                      إرسال النموذج
                    </button>
                  </div>
                )}

                {/* Footer */}
                <div className="text-center mt-8 text-gray-600">
                  <p>منشئ النماذج الذكي - مدعوم بالذكاء الاصطناعي</p>
                  <p className="text-sm mt-2">Built with React & Tailwind CSS</p>
                </div>
              </div>
            </div>
          );
        }

        ReactDOM.render(<FormBuilder />, document.getElementById('root'));
    </script>

</body></html>